<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="/static/img/favicon.png">
    <title>Data Analysis Results</title>
    
     
    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@3.9.4/dist/full.css"
      rel="stylesheet"
      type="text/css"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    
    <link rel="stylesheet" href="{{url_for( 'static', path='css/results.css')}}">
    <link rel="stylesheet" href="{{url_for( 'static', path='js/results.js')}}">
    
  </head>

  <body class="p-8">
    <div class="max-w-7xl mx-auto">
      <div class="text-center mb-8">
        <div class="flex items-center justify-center mb-2">
          <i class="fas fa-chart-line text-indigo-600 text-2xl mr-2"></i>
          <h1 class="text-2xl font-semibold gradient-text">
            Data Analysis Results
          </h1>
        </div>
        <p class="text-gray-500 text-sm">
          Comprehensive analysis of your uploaded dataset
        </p>
      </div>




      <div class="card mb-6 p-6">
        <div class="flex items-center mb-4">
          <div class="section-icon">
            <i class="fas fa-file-alt"></i>
          </div>
          <h2 class="text-lg font-semibold text-gray-800">File Information</h2>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div class="flex items-center">
            <span class="text-gray-500 text-sm mr-2">Filename:</span>
            <span class="text-gray-800">{{ file.filename }}</span>
          </div>
          <div class="flex items-center">
            <span class="text-gray-500 text-sm mr-2">Total Rows:</span>
            <span class="text-gray-800">{{ analysis.overview.shape.rows }}</span>

          </div>
          <div class="flex items-center">
            <span class="text-gray-500 text-sm mr-2">Total Columns:</span>
            <span class="text-gray-800"
              >{{ analysis.overview.shape.columns }}</span
            >
          </div>
          <div class="flex items-center">
            <span class="text-gray-500 text-sm mr-2">Duplicate Rows:</span>
            <span class="text-gray-800"
              >{{ analysis.overview.duplicate_count }}</span
            >
          </div>
        </div>
      </div>



      
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="wrappy">
        <div class="card p-6">
          <div class="flex items-center mb-4">
            <div class="section-icon">
              <i class="fas fa-table"></i>
            </div>
            <h2 class="text-lg font-semibold text-gray-800">
              Column Information
            </h2>
          </div>
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Column Name</th>
                  <th>Data Type</th>
                  <th>Unique Values</th>
                </tr>
              </thead>
              <tbody>
                {% for col in analysis.overview.column_data_types %} {% set
                unique =
                analysis.overview.unique_values|selectattr("column_name",
                "equalto", col.column_name)|first %}
                <tr>
                  <td>{{ col.column_name }}</td>
                  <td>{{ col.data_type }}</td>
                  <td>{{ unique.unique_values }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
        </div>

        <div class="card p-6">
          <div class="flex items-center mb-4">
            <div class="section-icon">
              <i class="fas fa-exclamation-triangle"></i>
            </div>
            <h2 class="text-lg font-semibold text-gray-800">
              Missing Data Analysis
            </h2>
          </div>
          {% if analysis.missing_data.missing_data is string %}
          <div class="status-badge status-success">
            {{ analysis.missing_data.missing_data }}
          </div>
          {% else %}
          <div class="table-container">
            <table>
              <thead>
                <tr>
                  <th>Column</th>
                  <th>Missing Count</th>
                  <th>Missing %</th>
                </tr>
              </thead>
              <tbody>
                {% for item in analysis.missing_data.missing_data %}
                <tr>
                  <td>{{ item.column }}</td>
                  <td>{{ item.missing_count }}</td>
                  <td>
                    <span
                      class="status-badge {% if item.missing_percentage > 20 %}status-error{% elif item.missing_percentage > 5 %}status-warning{% else %}status-success{% endif %}"
                    >
                      {{ item.missing_percentage }}%
                    </span>
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          {% endif %}
        </div>
      </div>



      

      {% if analysis.overview.descriptive_stats %}
<div class="card p-6 mt-6">
  <div class="flex items-center mb-4">
    <div class="section-icon">
      <i class="fas fa-calculator"></i>
    </div>
    <h2 class="text-lg font-semibold text-gray-800">
      Descriptive Statistics
    </h2>
  </div>
  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th class="font-medium sticky-col first-col">Metric</th>
          {% for column in analysis.overview.descriptive_stats.keys() %}
          <th class="font-medium">{{ column }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for stat in ['count', 'mean', 'std', 'min', '25%', '50%',
        '75%', 'max'] %}
        <tr>
          <td class="font-medium text-gray-700 sticky-col first-col">
            {% if stat == 'std' %} Standard Deviation {% elif stat ==
            'min' %} Minimum {% elif stat == 'max' %} Maximum {% elif stat
            == '25%' %} 25th Percentile {% elif stat == '50%' %} Median {%
            elif stat == '75%' %} 75th Percentile {% else %} {{ stat|title
            }} {% endif %}
          </td>
          {% for column in analysis.overview.descriptive_stats.keys() %}
          <td class="text-gray-600">
            {% set value =
            analysis.overview.descriptive_stats[column][stat] %} {% if
            value is not none %} {% if stat in ['count'] %} {{ value|int
            }} {% else %} {{ value|round(2) }} {% endif %} {% else %}
            <span class="text-gray-400">N/A</span>
            {% endif %}
          </td>
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endif %}


   



<div class="card p-6 mt-6">
  <div class="flex items-center mb-4">
    <div class="section-icon">
      <i class="fas fa-table"></i>
    </div>
    <h2 class="text-lg font-semibold text-gray-800">Data Preview</h2>
    <span class="ml-2 text-sm text-gray-500">(First 10 Rows)</span>
  </div>
  <div class="table-container">
    <table>
      <thead>
        <tr>
          {% for key in analysis.overview.table_head[0].keys() %}
          <th class="font-medium" title="{{ key|title }}">{{ key|title }}</th>
          {% endfor %}
        </tr>
      </thead>
      <tbody>
        {% for row in analysis.overview.table_head %}
        <tr>
          {% for value in row.values() %}
          <td class="text-gray-600">
            {% if value is none %}
              <span class="text-gray-400">N/A</span>
            {% elif value is number %}
              {% if value|round(0) == value %}
                {{ value|int }}
              {% else %}
                {{ value|round(2) }}
              {% endif %}
            {% else %}
              {{ value }}
            {% endif %}
          </td>
          {% endfor %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
</div>










<div class="card p-6 mt-6" id="ai_analysis_card">
  <div class="flex items-center mb-6">
    <div class="section-icon">
      <i class="fas fa-robot"></i>
    </div>
    <h2 class="text-lg font-semibold text-gray-800">
      AI Analysis Results
    </h2>
  </div>

  {% if ai_analysis.ai_result.error %}
  <div class="status-badge status-error">
    {{ ai_analysis.error }}
  </div>
  {% else %}



  <div class="mb-8">
    <div class="flex items-center mb-3">
      <i class="fas fa-info-circle text-indigo-600 mr-2"></i>
      <h3 class="text-md font-semibold text-gray-800">Summary</h3>
    </div>
    <div class="bg-gray-50 p-4 rounded-lg">
      <p class="text-gray-700 text-sm leading-relaxed">
        {{ ai_analysis.ai_result.summary }}
      </p>
    </div>
  </div>


  <div class="mb-8">
    <div class="flex items-center mb-4">
      <i class="fas fa-exclamation-circle text-indigo-600 mr-2"></i>
      <h3 class="text-md font-semibold text-gray-800">
        Data Quality Issues
      </h3>
    </div>


    {% if ai_analysis.ai_result.issues.critical %}
    <div class="mb-4">
      <h4 class="text-sm font-medium text-red-600 mb-2">
        Critical Issues
      </h4>
      <div class="space-y-3">
        {% for issue in ai_analysis.ai_result.issues.critical %}
        <div class="bg-red-50 p-4 rounded-lg border border-red-100">
          <div class="flex items-start">
            <i class="fas fa-times-circle text-red-500 mt-1 mr-2"></i>
            <div>
              <h5 class="font-medium text-red-800 text-sm">
                {{ issue.column }}
              </h5>
              <p class="text-gray-700 text-sm mt-1">{{ issue.issue }}</p>
              <p class="text-gray-600 text-sm mt-1">
                <strong>Impact:</strong> {{ issue.impact }}
              </p>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}

    
    
    {% if ai_analysis.ai_result.issues.moderate %}
    <div class="mb-4">
      <h4 class="text-sm font-medium text-amber-600 mb-2">
        Moderate Issues
      </h4>
      <div class="space-y-3">
        {% for issue in ai_analysis.ai_result.issues.moderate %}
        <div class="bg-amber-50 p-4 rounded-lg border border-amber-100">
          <div class="flex items-start">
            <i
              class="fas fa-exclamation-circle text-amber-500 mt-1 mr-2"
            ></i>
            <div>
              <h5 class="font-medium text-amber-800 text-sm">
                {{ issue.column }}
              </h5>
              <p class="text-gray-700 text-sm mt-1">{{ issue.issue }}</p>
              <p class="text-gray-600 text-sm mt-1">
                <strong>Impact:</strong> {{ issue.impact }}
              </p>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  
    {% endif %}




    {% if ai_analysis.ai_result.issues.minor %}
    <div class="mb-4">
      <h4 class="text-sm font-medium text-blue-600 mb-2">Minor Issues</h4>
      <div class="space-y-3">
        {% for issue in ai_analysis.ai_result.issues.minor %}
        <div class="bg-blue-50 p-4 rounded-lg border border-blue-100">
          <div class="flex items-start">
            <i class="fas fa-info-circle text-blue-500 mt-1 mr-2"></i>
            <div>
              <h5 class="font-medium text-blue-800 text-sm">
                {{ issue.column }}
              </h5>
              <p class="text-gray-700 text-sm mt-1">{{ issue.issue }}</p>
              <p class="text-gray-600 text-sm mt-1">
                <strong>Impact:</strong> {{ issue.impact }}
              </p>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>


  {% if ai_analysis.ai_result.recommendations %}
  <div class="mb-8">
    <div class="flex items-center mb-4">
      <i class="fas fa-lightbulb text-indigo-600 mr-2"></i>
      <h3 class="text-md font-semibold text-gray-800">Recommendations</h3>
    </div>
    <div class="space-y-3">
      {% for rec in ai_analysis.ai_result.recommendations %}
      <div class="bg-green-50 p-4 rounded-lg border border-green-100">
        <div class="flex items-start">
          <i class="fas fa-check-circle text-green-500 mt-1 mr-2"></i>
          <p class="text-gray-700 text-sm">{{ rec }}</p>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
  {% endif %}
  {% endif %}

</div>




</div>
</body>
</html>
